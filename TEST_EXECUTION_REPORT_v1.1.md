# π“‹ CertiGraph v1.1 ν…μ¤νΈ μ‹¤ν–‰ λ³΄κ³ μ„

## π“… μ‹¤ν–‰ μ •λ³΄
- **μ‹¤ν–‰ μΌμ‹**: 2026-01-11 07:47 KST
- **ν…μ¤νΈ λ²”μ„**: κ²°μ  μ‹μ¤ν…, μ‹ν—μΌ μ¶”μ², μ¤λ‹µλ…ΈνΈ κΈ°λ¥
- **ν…μ¤νΈ λ¬Έμ„**: `docs/test-design-v1.1-update.md`
- **μ‹¤ν–‰μ**: Antigravity AI Assistant

## π― ν…μ¤νΈ λ©ν‘

v1.1 μ—…λ°μ΄νΈμ— ν¬ν•¨λ λ‹¤μ ν•µμ‹¬ κΈ°λ¥ κ²€μ¦:
1. **κ²°μ  μ‹μ¤ν…** (Epic 5): Toss Payments μ—°λ™
2. **μ‹ν—μΌ μλ™ μ¶”μ²** (Epic 2): κ°€μ¥ κ°€κΉμ΄ ν•„κΈ° μ‹ν—μΌ μ¶”μ²
3. **μ¤λ‹µ λ…ΈνΈ λ¨λ“** (Epic 3): ν‹€λ¦° λ¬Έμ λ§ ν•„ν„°λ§ν•μ—¬ μ¬μ‹ν—

---

## β… λ°±μ—”λ“ λ‹¨μ„ ν…μ¤νΈ κ²°κ³Ό

### μ‹¤ν–‰ λ…λ Ή
```bash
pytest tests/unit/test_payment.py tests/unit/test_certification.py tests/unit/test_retest.py -v
```

### κ²°κ³Ό μ”μ•½
- **μ΄ ν…μ¤νΈ**: 8κ°
- **ν†µκ³Ό**: β… 8κ° (100%)
- **μ‹¤ν¨**: 0κ°
- **μ‹¤ν–‰ μ‹κ°„**: 6.16μ΄

### ν…μ¤νΈ μƒμ„Έ

#### 1. κ²°μ  μ‹μ¤ν… ν…μ¤νΈ (test_payment.py)
| ν…μ¤νΈ ID | ν…μ¤νΈ ν•­λ© | κ²°κ³Ό | μ„¤λ… |
|-----------|------------|------|------|
| BE-UNIT-PAY-001 | `test_create_payment` | β… PASS | κ²°μ  μ”μ²­ κ°μ²΄ μƒμ„± λ° orderId ν•μ‹ κ²€μ¦ |
| BE-UNIT-PAY-002 | `test_confirm_payment_success` | β… PASS | PG μΉμΈ API λ¨μ νΈμ¶ λ° μ„±κ³µ μ²λ¦¬ |
| BE-UNIT-PAY-003 | `test_repo_update_status` | β… PASS | DB μ—…λ°μ΄νΈ μΏΌλ¦¬ μƒμ„± λ° μ‹¤ν–‰ |

**κ²€μ¦ λ‚΄μ©**:
- β… κ²°μ  κΈμ•΅ 10,000μ› ν™•μΈ
- β… Order ID ν•μ‹ `ORDER_` μ ‘λ‘μ‚¬ ν™•μΈ
- β… Success URL μ„¤μ • ν™•μΈ
- β… Toss Payments API λ¨ν‚Ή μ„±κ³µ
- β… DB μƒνƒ μ—…λ°μ΄νΈ (`is_paid=True`) ν™•μΈ

#### 2. μ‹ν—μΌ μ¶”μ² ν…μ¤νΈ (test_certification.py)
| ν…μ¤νΈ ID | ν…μ¤νΈ ν•­λ© | κ²°κ³Ό | μ„¤λ… |
|-----------|------------|------|------|
| BE-UNIT-CERT-001 | `test_get_upcoming_exams` | β… PASS | λ‹¤κ°€μ¤λ” μ‹ν— μ΅°ν |
| BE-UNIT-CERT-002 | `test_get_nearest_exam_logic` | β… PASS | κ°€μ¥ κ°€κΉμ΄ μ‹ν—μΌ ν•„ν„°λ§ λ΅μ§ |

**κ²€μ¦ λ‚΄μ©**:
- β… ν–¥ν›„ 365μΌ λ‚΄ μ‹ν— μ΅°ν
- β… `ExamType.WRITTEN` ν•„ν„°λ§
- β… D-Day κ³„μ‚° μ •ν™•μ„± (30μΌ ν›„ μ‹ν— = 30)
- β… κ³Όκ±° λ‚ μ§ μ μ™Έ ν™•μΈ

#### 3. μ¤λ‹µλ…ΈνΈ ν…μ¤νΈ (test_retest.py)
| ν…μ¤νΈ ID | ν…μ¤νΈ ν•­λ© | κ²°κ³Ό | μ„¤λ… |
|-----------|------------|------|------|
| BE-UNIT-TEST-001 | `test_start_session_wrong_only_mode` | β… PASS | μ¤λ‹µ λ…ΈνΈ λ¨λ“ μ„Έμ… μ‹μ‘ |
| BE-UNIT-TEST-002 | `test_start_session_wrong_only_empty` | β… PASS | μ¤λ‹µμ΄ μ—†μ„ λ• μ „μ²΄ λ¬Έμ λ΅ ν΄λ°± |
| BE-UNIT-TEST-003 | `test_repo_get_wrong_ids_logic` | β… PASS | μ¤λ‹µ ID μ¶”μ¶ λ΅μ§ (μµμ‹  μ‹λ„ κΈ°μ¤€) |

**κ²€μ¦ λ‚΄μ©**:
- β… `TestMode.WRONG_ONLY` λ¨λ“ μ§€μ›
- β… μ¤λ‹µ λ¬Έμ  ID μ΅°ν (`get_wrong_question_ids`)
- β… μµμ‹  μ‹λ„μ—μ„ μ •λ‹µμΈ λ¬Έμ  μ μ™Έ
- β… μ¤λ‹µμ΄ μ—†μ„ λ• μ „μ²΄ λ¬Έμ λ΅ ν΄λ°±

---

## π E2E ν…μ¤νΈ κ²°κ³Ό

### 1. κ²°μ  ν”λ΅μ° ν…μ¤νΈ (payment-flow.spec.ts)

#### μ‹¤ν–‰ λ…λ Ή
```bash
npx playwright test tests/e2e/payment/payment-flow.spec.ts --project=payment-sequential --reporter=list
```

#### κ²°κ³Ό μ”μ•½
- **μ΄ ν…μ¤νΈ**: 12κ°
- **ν†µκ³Ό**: β… 2κ° (16.7%)
- **μ‹¤ν¨**: β 1κ° (8.3%)
- **μ¤ν‚µ**: β­οΈ 9κ° (75%)
- **μ‹¤ν–‰ μ‹κ°„**: 38.6μ΄

#### ν…μ¤νΈ μƒμ„Έ

| ν…μ¤νΈ ID | ν…μ¤νΈ ν•­λ© | κ²°κ³Ό | λΉ„κ³  |
|-----------|------------|------|------|
| PAY-001 | Pricing page displays season pass | β… PASS | κ°€κ²© μ •λ³΄ ν‘μ‹ ν™•μΈ |
| PAY-002 | Select certification and initiate payment | β­οΈ SKIP | κµ¬λ§¤ λ²„νΌ λΉ„ν™μ„±ν™” |
| PAY-003 | Payment widget loads correctly | β… PASS | Toss μ„μ ― λ΅λ“ ν™•μΈ |
| PAY-004 | Display payment amount and order details | β FAIL | μ£Όλ¬Έ κΈμ•΅ ν‘μ‹ λ„λ½ |
| PAY-005 ~ PAY-012 | λ‚λ¨Έμ§€ κ²°μ  ν…μ¤νΈ | β­οΈ SKIP | μ΄μ „ ν…μ¤νΈ μ‹¤ν¨λ΅ μ¤ν‚µ |

#### μ‹¤ν¨ μ›μΈ λ¶„μ„

**PAY-004 μ‹¤ν¨ μ›μΈ**:
```
Error: expect(locator).toBeVisible() failed
Locator: locator('text=/10,000|β‚©10,000/i').first()
Expected: visible
Timeout: 5000ms
```

**κ·Όλ³Έ μ›μΈ**:
- `/checkout` νμ΄μ§€μ— μ£Όλ¬Έ κΈμ•΅ ν‘μ‹ μ”μ† λ„λ½
- μ„ νƒμ `text=/10,000|β‚©10,000/i`μ— λ§¤μΉ­λλ” μ”μ† μ—†μ

**κ¶μ¥ μμ • μ‚¬ν•­**:
1. `/checkout` νμ΄μ§€μ— μ£Όλ¬Έ μ”μ•½ μ„Ήμ… μ¶”κ°€
2. κΈμ•΅ ν‘μ‹ μ»΄ν¬λ„νΈ κµ¬ν„ (β‚©10,000 ν•μ‹)
3. μκ²©μ¦ μ΄λ¦„ ν‘μ‹ μ¶”κ°€

### 2. μ¤λ‹µλ…ΈνΈ ν…μ¤νΈ (bmad-mock-exam.spec.ts)

#### μ‹¤ν–‰ λ…λ Ή
```bash
npx playwright test tests/e2e/bmad-mock-exam.spec.ts -g "μ¤λ‹µλ…ΈνΈ" --project=study-exam-partial
```

#### κ²°κ³Ό μ”μ•½
- **μ΄ ν…μ¤νΈ**: 5κ°
- **ν†µκ³Ό**: 0κ°
- **μ‹¤ν¨**: β 3κ° (60%)
- **λ―Έμ‹¤ν–‰**: 2κ° (40%)
- **μ‹¤ν–‰ μ‹κ°„**: μ¤‘λ‹¨λ¨

#### ν…μ¤νΈ μƒμ„Έ

| ν…μ¤νΈ ID | ν…μ¤νΈ ν•­λ© | κ²°κ³Ό | μ‹¤ν¨ μ›μΈ |
|-----------|------------|------|----------|
| 116 | μ¤λ‹µλ…ΈνΈ μλ™ μƒμ„± | β FAIL | λ΅κ·ΈμΈ νμ΄μ§€ μ„ νƒμ λ¶μΌμΉ |
| 117 | μ¤λ‹µλ…ΈνΈ λ¬Έμ  λ³µμµ | β FAIL | λ΅κ·ΈμΈ νμ΄μ§€ μ„ νƒμ λ¶μΌμΉ |
| 118 | μ¤λ‹µλ…ΈνΈ νƒκ·Έ μ¶”κ°€ | β FAIL | λ΅κ·ΈμΈ νμ΄μ§€ μ„ νƒμ λ¶μΌμΉ |
| 119 | μ¤λ‹µλ…ΈνΈ λ©”λ¨ μ‘μ„± | β­οΈ NOT RUN | μ΄μ „ ν…μ¤νΈ μ‹¤ν¨ |
| 120 | μ¤λ‹µλ…ΈνΈ μ™„λ£ μ²΄ν¬ | β­οΈ NOT RUN | μ΄μ „ ν…μ¤νΈ μ‹¤ν¨ |

#### μ‹¤ν¨ μ›μΈ λ¶„μ„

**κ³µν†µ μ‹¤ν¨ μ›μΈ**:
```
TimeoutError: page.fill: Timeout 15000ms exceeded.
Call log:
  - waiting for locator('[name="email"]')
```

**κ·Όλ³Έ μ›μΈ**:
- λ΅κ·ΈμΈ νμ΄μ§€ URL: `http://localhost:3030/login` (404 λλ” λ‹¤λ¥Έ κµ¬μ΅°)
- ν„μ¬ ν”„λ΅μ νΈλ” Clerk μΈμ¦ μ‚¬μ© (μ΄λ©”μΌ/λΉ„λ°€λ²νΈ νΌ μ—†μ)
- ν…μ¤νΈ ν—¬νΌ ν•¨μ `loginAsUser`κ°€ κµ¬μ‹ μΈμ¦ λ°©μ‹ μ‚¬μ©

**κ¶μ¥ μμ • μ‚¬ν•­**:
1. Clerk μΈμ¦μ— λ§κ² `loginAsUser` ν•¨μ μμ •
2. ν…μ¤νΈ μ‚¬μ©μ κ³„μ • Clerkμ— λ“±λ΅
3. λλ” Clerk ν…μ¤νΈ λ¨λ“ ν™μ„±ν™”

---

## π“ μ „μ²΄ ν…μ¤νΈ κ²°κ³Ό μ”μ•½

### μ„±κ³µλ¥ 
```
λ°±μ—”λ“ λ‹¨μ„ ν…μ¤νΈ:  β… 8/8   (100%)
κ²°μ  E2E ν…μ¤νΈ:     β… 2/12  (16.7%)
μ¤λ‹µλ…ΈνΈ E2E ν…μ¤νΈ: β 0/5   (0%)
β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€
μ „μ²΄:               β… 10/25 (40%)
```

### μΉ΄ν…κ³ λ¦¬λ³„ κ²°κ³Ό

| κΈ°λ¥ | λ°±μ—”λ“ | E2E | μ „μ²΄ μƒνƒ |
|------|--------|-----|----------|
| **κ²°μ  μ‹μ¤ν…** | β… 100% (3/3) | β οΈ 16.7% (2/12) | β οΈ λ¶€λ¶„ μ™„λ£ |
| **μ‹ν—μΌ μ¶”μ²** | β… 100% (2/2) | β­οΈ λ―Έμ‹¤ν–‰ | β οΈ λ°±μ—”λ“λ§ κ²€μ¦ |
| **μ¤λ‹µλ…ΈνΈ** | β… 100% (3/3) | β 0% (0/5) | β οΈ λ°±μ—”λ“λ§ κ²€μ¦ |

---

## π› λ°κ²¬λ μ΄μ

### Critical Issues

#### ISSUE-001: κ²°μ  νμ΄μ§€ μ£Όλ¬Έ μ”μ•½ λ„λ½
- **μ°μ„ μμ„**: P0 (Critical)
- **μν–¥ λ²”μ„**: κ²°μ  ν”λ΅μ°
- **μ„¤λ…**: `/checkout` νμ΄μ§€μ— μ£Όλ¬Έ κΈμ•΅ λ° μƒμ„Έ μ •λ³΄ ν‘μ‹ λ„λ½
- **μ¬ν„ λ‹¨κ³„**:
  1. `/checkout?certification=μ •λ³΄μ²λ¦¬κΈ°μ‚¬&price=10000` μ ‘κ·Ό
  2. νμ΄μ§€μ—μ„ "β‚©10,000" λλ” "10,000" ν…μ¤νΈ κ²€μƒ‰
  3. μ”μ†λ¥Ό μ°Ύμ„ μ μ—†μ
- **κ¶μ¥ μμ •**:
  ```tsx
  // frontend/src/app/(dashboard)/checkout/page.tsx
  <div className="order-summary">
    <h2>μ£Όλ¬Έ μ”μ•½</h2>
    <div className="order-item">
      <span>μκ²©μ¦</span>
      <span>{certificationName}</span>
    </div>
    <div className="order-total">
      <span>μ΄ κ²°μ  κΈμ•΅</span>
      <span className="amount">β‚©10,000</span>
    </div>
  </div>
  ```

#### ISSUE-002: μΈμ¦ μ‹μ¤ν… λ¶μΌμΉ
- **μ°μ„ μμ„**: P0 (Critical)
- **μν–¥ λ²”μ„**: λ¨λ“  E2E ν…μ¤νΈ
- **μ„¤λ…**: ν…μ¤νΈλ” μ΄λ©”μΌ/λΉ„λ°€λ²νΈ λ΅κ·ΈμΈμ„ κ°€μ •ν•μ§€λ§, μ‹¤μ λ΅λ” Clerk μ‚¬μ©
- **μ¬ν„ λ‹¨κ³„**:
  1. `/login` νμ΄μ§€ μ ‘κ·Ό
  2. `[name="email"]` μ„ νƒμλ΅ μ…λ ¥ ν•„λ“ κ²€μƒ‰
  3. Timeout λ°μƒ (Clerk UIλ” λ‹¤λ¥Έ κµ¬μ΅°)
- **κ¶μ¥ μμ •**:
  ```typescript
  // tests/helpers/auth.ts
  async function loginWithClerk(page: Page) {
    await page.goto(`${FRONTEND_URL}/sign-in`);
    // Clerk μ„ νƒμ μ‚¬μ©
    await page.locator('.cl-formFieldInput[name="identifier"]').fill('test@example.com');
    await page.locator('.cl-formFieldInput[name="password"]').fill('Test1234!');
    await page.locator('.cl-formButtonPrimary').click();
    await page.waitForURL(`${FRONTEND_URL}/dashboard`);
  }
  ```

### Medium Issues

#### ISSUE-003: μ¤λ‹µλ…ΈνΈ νμ΄μ§€ λ―Έκµ¬ν„
- **μ°μ„ μμ„**: P1 (High)
- **μν–¥ λ²”μ„**: μ¤λ‹µλ…ΈνΈ κΈ°λ¥
- **μ„¤λ…**: `/review/{id}` νμ΄μ§€ λ° κ΄€λ ¨ UI μ»΄ν¬λ„νΈ λ―Έκµ¬ν„
- **κ¶μ¥ μμ •**: μ¤λ‹µλ…ΈνΈ νμ΄μ§€ κµ¬ν„ ν•„μ”

---

## π― λ‹¤μ λ‹¨κ³„

### μ¦‰μ‹ μ΅°μΉ (P0)
1. β… **λ°±μ—”λ“ λ‹¨μ„ ν…μ¤νΈ μ™„λ£** - λ¨λ“  ν…μ¤νΈ ν†µκ³Ό
2. β³ **κ²°μ  νμ΄μ§€ μ£Όλ¬Έ μ”μ•½ μ¶”κ°€** - ISSUE-001 μμ •
3. β³ **μΈμ¦ ν…μ¤νΈ ν—¬νΌ μμ •** - ISSUE-002 μμ •

### λ‹¨κΈ° μ΅°μΉ (1-2μΌ)
4. β³ **μ¤λ‹µλ…ΈνΈ νμ΄μ§€ κµ¬ν„** - ISSUE-003 μμ •
5. β³ **μ‹ν—μΌ μ¶”μ² E2E ν…μ¤νΈ μ‘μ„±**
6. β³ **κ²°μ  ν”λ΅μ° μ „μ²΄ ν…μ¤νΈ μ¬μ‹¤ν–‰**

### μ¤‘κΈ° μ΅°μΉ (1μ£Ό)
7. β³ **ν†µν•© ν…μ¤νΈ μ¶”κ°€** - API μ—°λ™ κ²€μ¦
8. β³ **CI/CD νμ΄ν”„λΌμΈ ν†µν•©**
9. β³ **μλ™ν™”λ νκ·€ ν…μ¤νΈ**

---

## π’΅ κ¶μ¥ μ‚¬ν•­

### 1. ν…μ¤νΈ ν™κ²½ κ°μ„ 
- **Clerk ν…μ¤νΈ λ¨λ“**: ν…μ¤νΈ μ „μ© Clerk ν™κ²½ μ„¤μ •
- **Mock λ°μ΄ν„°**: μΌκ΄€λ ν…μ¤νΈ λ°μ΄ν„° Fixture μƒμ„±
- **ν™κ²½ λ³€μ**: `.env.test` νμΌλ΅ ν…μ¤νΈ ν™κ²½ λ¶„λ¦¬

### 2. νμ΄μ§€ κµ¬ν„ μ°μ„ μμ„
1. **κ²°μ  νμ΄μ§€** (`/checkout`) - μ£Όλ¬Έ μ”μ•½ μ„Ήμ…
2. **μ¤λ‹µλ…ΈνΈ νμ΄μ§€** (`/review/{id}`) - μ „μ²΄ κΈ°λ¥
3. **μ‹ν—μΌ μ¶”μ² UI** - λ€μ‹λ³΄λ“ λλ” μκ²©μ¦ μ„ νƒ νμ΄μ§€

### 3. ν…μ¤νΈ μ „λµ
- **λ‹¨μ„ ν…μ¤νΈ**: β… μ μ‘λ™ μ¤‘ - κ³„μ† μ μ§€
- **E2E ν…μ¤νΈ**: β οΈ νμ΄μ§€ κµ¬ν„ ν›„ μ¬μ‹¤ν–‰ ν•„μ”
- **ν†µν•© ν…μ¤νΈ**: π“ API μ—”λ“ν¬μΈνΈ κ²€μ¦ μ¶”κ°€ ν•„μ”

---

## π“ μ„±κ³Ό

### λ‹¬μ„±ν• λ©ν‘
- β… **λ°±μ—”λ“ λ΅μ§ κ²€μ¦ μ™„λ£** (100% ν†µκ³Ό)
- β… **κ²°μ  μ‹μ¤ν… ν•µμ‹¬ λ΅μ§ κ²€μ¦**
- β… **μ‹ν—μΌ μ¶”μ² μ•κ³ λ¦¬μ¦ κ²€μ¦**
- β… **μ¤λ‹µλ…ΈνΈ ν•„ν„°λ§ λ΅μ§ κ²€μ¦**

### λ°κ²¬ν• κ°μ„  μ‚¬ν•­
- π“ κ²°μ  νμ΄μ§€ UI κ°μ„  ν•„μ”
- π“ μ¤λ‹µλ…ΈνΈ νμ΄μ§€ κµ¬ν„ ν•„μ”
- π“ Clerk μΈμ¦ ν…μ¤νΈ ν—¬νΌ μ—…λ°μ΄νΈ ν•„μ”

---

**μ‘μ„±μΌ**: 2026-01-11 07:47 KST  
**μ‘μ„±μ**: Antigravity AI Assistant  
**μƒνƒ**: β… λ°±μ—”λ“ κ²€μ¦ μ™„λ£, β οΈ ν”„λ΅ νΈμ—”λ“ λ¶€λ¶„ μ™„λ£  
**λ‹¤μ μ—…λ°μ΄νΈ**: μ΄μ μμ • ν›„ μ¬ν…μ¤νΈ
